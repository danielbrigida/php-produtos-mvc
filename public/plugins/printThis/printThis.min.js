
(function(b){function d(f,g){if(!g){return}f.append(g.jquery?g.clone():g)}function e(i,f,h){var g=f.clone(h.formValues);if(h.formValues){c(f,g,"select, textarea")}if(h.removeScripts){g.find("script").remove()}if(h.printContainer){g.appendTo(i)}else{g.each(function(){b(this).children().appendTo(i)})}}function c(f,i,g){var h=f.find(g);i.find(g).each(function(j,k){b(k).val(h.eq(j).val())})}var a;b.fn.printThis=function(g){a=b.extend({},b.fn.printThis.defaults,g);var f=this instanceof jQuery?this:b(this);var i="printThis-"+(new Date()).getTime();if(window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)){var l='javascript:document.write("<head><script>document.domain=\\"'+document.domain+'\\";<\/script></head><body></body>")';var k=document.createElement("iframe");k.name="printIframe";k.id=i;k.className="MSIE";document.body.appendChild(k);k.src=l}else{var h=b("<iframe id='"+i+"' name='printIframe' />");h.appendTo("body")}var j=b("#"+i);if(!a.debug){j.css({position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"})}setTimeout(function(){function o(x,u){var w,v;w=x.get(0);w=w.contentWindow||w.contentDocument||w;v=w.document||w.contentDocument||w;v.open();v.write(u);v.close()}if(a.doctypeString){o(j,a.doctypeString)}var t=j.contents(),n=t.find("head"),r=t.find("body"),p=b("base"),q;if(a.base===true&&p.length>0){q=p.attr("href")}else{if(typeof a.base==="string"){q=a.base}else{q=document.location.protocol+"//"+document.location.host}}n.append('<base href="'+q+'">');if(a.importCSS){b("link[rel=stylesheet]").each(function(){var u=b(this).attr("href");if(u){var v=b(this).attr("media")||"all";n.append("<link type='text/css' rel='stylesheet' href='"+u+"' media='"+v+"'>")}})}if(a.importStyle){b("style").each(function(){b(this).clone().appendTo(n)})}if(a.pageTitle){n.append("<title>"+a.pageTitle+"</title>")}if(a.loadCSS){if(b.isArray(a.loadCSS)){jQuery.each(a.loadCSS,function(u,v){n.append("<link type='text/css' rel='stylesheet' href='"+this+"'>")})}else{n.append("<link type='text/css' rel='stylesheet' href='"+a.loadCSS+"'>")}}var m=a.copyTagClasses;if(m){m=m===true?"bh":m;if(m.indexOf("b")!==-1){r.addClass(b("body")[0].className)}if(m.indexOf("h")!==-1){t.find("html").addClass(b("html")[0].className)}}d(r,a.header);if(a.canvas){var s=0;f.find("canvas").each(function(){b(this).attr("data-printthis",s++)})}e(r,f,a);if(a.canvas){r.find("canvas").each(function(){var v=b(this).data("printthis"),u=b('[data-printthis="'+v+'"]');this.getContext("2d").drawImage(u[0],0,0);u.removeData("printthis")})}if(a.removeInline){if(b.isFunction(b.removeAttr)){t.find("body *").removeAttr("style")}else{t.find("body *").attr("style","")}}d(r,a.footer);setTimeout(function(){if(j.hasClass("MSIE")){window.frames.printIframe.focus();n.append("<script>  window.print(); <\/script>")}else{if(document.queryCommandSupported("print")){j[0].contentWindow.document.execCommand("print",false,null)}else{j[0].contentWindow.focus();j[0].contentWindow.print()}}if(!a.debug){setTimeout(function(){j.remove()},1000)}},a.printDelay)},333)};b.fn.printThis.defaults={debug:false,importCSS:true,importStyle:false,printContainer:true,loadCSS:"",pageTitle:"",removeInline:false,printDelay:333,header:null,footer:null,formValues:true,canvas:false,base:false,doctypeString:"<!DOCTYPE html>",removeScripts:false,copyTagClasses:false}})(jQuery);