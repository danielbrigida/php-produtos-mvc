(function(a){var b;var c=function(h,d,e){var i=this,f=a(h),j={byPassKeys:[8,9,37,38,39,40],maskChars:{":":":","-":"-",".":"\\.","(":"\\(",")":"\\)","/":"/",",":",",_:"_"," ":"\\s","+":"\\+"},translationNumbers:{0:"\\d",1:"\\d",2:"\\d",3:"\\d",4:"\\d",5:"\\d",6:"\\d",7:"\\d",8:"\\d",9:"\\d"},translation:{A:"[a-zA-Z0-9]",S:"[a-zA-Z]"}};i.init=function(){i.settings={};e=e||{};j.translation=a.extend({},j.translation,j.translationNumbers);i.settings=a.extend(true,{},j,e);i.settings.specialChars=a.extend({},i.settings.maskChars,i.settings.translation);f.each(function(){d=g.resolveMask();d=g.fixRangeMask(d);f.attr("maxlength",d.length);f.attr("autocomplete","off");g.destroyEvents();g.setOnKeyUp();g.setOnPaste()})};var g={onPasteMethod:function(){setTimeout(function(){f.trigger("keyup")},100)},setOnPaste:function(){if(g.hasOnSupport()){f.on("paste",g.onPasteMethod)}else{f=f.get(0);f.addEventListener?f.addEventListener("paste",g.onPasteMethod,false):f.attachEvent("paste",g.onPasteMethod)}},setOnKeyUp:function(){f.keyup(g.maskBehaviour).trigger("keyup")},hasOnSupport:function(){return a.isFunction(a().on)},destroyEvents:function(){f.unbind("keyup").unbind("onpaste")},resolveMask:function(){return typeof d=="function"?d(g.getVal(),b,e):d},setVal:function(k){f.get(0).tagName.toLowerCase()==="input"?f.val(k):f.html(k);return f},getVal:function(){return f.get(0).tagName.toLowerCase()==="input"?f.val():f.text()},specialChar:function(k,l){return i.settings.specialChars[k.charAt(l)]},maskChar:function(k,l){return i.settings.maskChars[k.charAt(l)]},maskBehaviour:function(m){m=m||window.event;var l=m.keyCode||m.which;if(a.inArray(l,i.settings.byPassKeys)>-1){return true}var k=g.applyMask(d);if(k!==g.getVal()){g.setVal(k).trigger("change")}return g.seekCallbacks(m,k)},applyMask:function(m){if(g.getVal()===""){return}var r=function(k,s){while(s<k.length){if(k[s]!==undefined){return true}s++}return false},p=function(k){k=(typeof k==="string")?k:k.join("");var s=k.match(new RegExp(g.maskToRegex(m)))||[];s.shift();return s},q=g.getVal(),m=g.getMask(q,m),q=e.reverse?g.removeMaskChars(q):q,l,o=p(q);while(o.join("").length<g.removeMaskChars(q).length){o=o.join("").split("");q=g.removeMaskChars(o.join("")+q.substring(o.length+1));m=g.getMask(q,m);o=p(q)}for(var n=0;n<o.length;n++){l=g.specialChar(m,n);if(g.maskChar(m,n)&&r(o,n)){o[n]=m.charAt(n)}else{if(l){if(o[n]!==undefined){if(o[n].match(new RegExp(l))===null){break}}else{if("".match(new RegExp(l))===null){o=o.slice(0,n);break}}}}}return o.join("")},getMask:function(l){var k=function(o){o=g.removeMaskChars(o);var r=0,q=0,n=0,p=d.length;r=(p>=1)?p:p-1;q=r;while(n<o.length){while(g.maskChar(d,q-1)){q--}q--;n++}q=(d.length>=1)?q:q-1;return d.substring(r,q)};return e.reverse?k(l):d},maskToRegex:function(k){var n;for(var l=0,m="";l<k.length;l++){n=g.specialChar(k,l);if(n){m+="("+n+")?"}}return m},fixRangeMask:function(k){var m=function(o,n){return new Array(n+1).join(o)},l=/([A-Z0-9])\{(\d+)?,([(\d+)])\}/g;return k.replace(l,function(){var o=arguments,n=[],p=(i.settings.translationNumbers[o[1]])?String.fromCharCode(parseInt("6"+o[1],16)):o[1].toLowerCase();n[0]=o[1];n[1]=m(o[1],o[2]-1);n[2]=m(p,o[3]-o[2]).toLowerCase();i.settings.specialChars[p]=g.specialChar(o[1])+"?";return n.join("")})},removeMaskChars:function(k){a.each(i.settings.maskChars,function(m,l){k=k.replace(new RegExp("("+i.settings.maskChars[m]+")?","g"),"")});return k},seekCallbacks:function(l,k){if(e.onKeyPress&&l.isTrigger===undefined&&typeof e.onKeyPress=="function"){e.onKeyPress(k,l,f,e)}if(e.onComplete&&l.isTrigger===undefined&&k.length===d.length&&typeof e.onComplete=="function"){e.onComplete(k,l,f,e)}}};if(typeof QUNIT==="boolean"){i.__p=g}i.remove=function(){g.destroyEvents();g.setVal(g.removeMaskChars(g.getVal()));f.removeAttr("maxlength")};i.init()};a.fn.mask=function(d,e){return this.each(function(){a(this).data("mask",new c(this,d,e))})};a("input[data-mask]").each(function(){a(this).mask(a(this).attr("data-mask"))})})(window.jQuery||window.Zepto);